# 뉴스 리포트 분석 전략 가이드

## 개요

본 문서는 Claude Sonnet 4.5를 활용한 뉴스 분석 리포트 생성 시스템의 핵심 전략과 프롬프트 설계 철학을 설명합니다.

## 목차

- [시스템 아키텍처](#시스템-아키텍처)
- [분석 철학](#분석-철학)
- [프롬프트 엔지니어링](#프롬프트-엔지니어링)
- [분석 프레임워크](#분석-프레임워크)
- [출력 구조](#출력-구조)
- [품질 관리](#품질-관리)

---

## 시스템 아키텍처

### 핵심 컴포넌트

```
뉴스 수집 (FMP API)
    ↓
뉴스 전처리 & AI 감정 분석
    ↓
Claude Sonnet 4.5 분석
    ↓
구조화된 JSON 리포트
    ↓
PDF 생성 & 사용자 제공
```

### 파일 구조

- **서비스**: `app/services/claude_service.py`
- **API 엔드포인트**: `app/api/news_report_v1.py`
- **프롬프트 메서드**: `ClaudeService._build_report_prompt()`

---

## 분석 철학

### 1. 역할 설정: Senior AI Market Analyst

일반적인 "금융 애널리스트"가 아닌, **월스트리트 최상위 헤지펀드의 시니어 AI 애널리스트** 역할을 부여합니다.

**목적:**
- 단순 사실 요약이 아닌 **인사이트 도출**
- 대중이 보지 못하는 **행간의 의미(Hidden Nuance)** 파악
- 투자자가 "내가 몰랐던 통찰"을 얻게 함

### 2. 노이즈와 시그널의 분리

```
노이즈 (Noise)          시그널 (Signal)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
반복 기사               독점 정보
광고성 콘텐츠           펀더멘털 변화
자극적 제목             실제 재료
추측성 보도             공식 발표
```

**AI의 역할:**
- 같은 내용의 반복 기사 필터링
- 제목과 본문의 괴리 분석 (낚시성 판별)
- 실제 영향력 있는 정보만 추출

### 3. 역발상(Contrarian) 관점

```
시장 상황              AI 분석 방향
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
뉴스가 지나치게 긍정적  → 과열/고점 경고
뉴스가 지나치게 부정적  → 과매도 기회 제시
군중 심리 과열          → 역발상 전략 제안
```

---

## 프롬프트 엔지니어링

### 입력 데이터 구조

```python
# 각 뉴스 기사당 제공되는 정보
{
    "title": str,              # 제목
    "body": str[:2000],        # 본문 (최대 2000자)
    "source": str,             # 출처
    "published_at": datetime,  # 발행일
    "positive_score": float,   # AI 감정 점수 (0-1)
    "ai_analyzed_text": str    # 사전 AI 분석
}
```

### 프롬프트 4대 원칙

#### 1. 노이즈 필터링

```
지침: 같은 내용의 반복 기사나 영양가 없는 기사는
      과감히 무시하거나 '노이즈'로 규정하십시오.

예시 출력:
"20건의 뉴스 중 유의미한 팩트는 3건입니다.
 나머지는 동일 소식의 재배포이거나 추측성 기사입니다."
```

#### 2. 낚시성 판별

```
지침: 제목이 자극적이나 본문은 별거 없다면,
      이를 명확히 지적하십시오.

예시 출력:
"헤드라인은 '급등 전망'이나 본문 팩트는
 단순 애널리스트 1인의 개인 의견에 불과함"
```

#### 3. 심리 분석

```
지침: 경영진의 발언이나 기사의 어조에서
      '자신감' 또는 '불안감'을 감지하여 분석하십시오.

예시 출력:
"CEO의 어조에서 '신중한 낙관'이 감지됨.
 구체적 수치 제시는 없으나 자신감은 유지."
```

#### 4. 역발상(Contrarian)

```
지침: 뉴스가 지나치게 긍정적이라면 '과열/고점'의 가능성을,
      지나치게 부정적이라면 '과매도'의 기회를 언급하십시오.

예시 출력:
"현재 뉴스 심리는 euphoric 단계.
 역사적으로 이런 시기에는 단기 조정이 빈번했음."
```

---

## 분석 프레임워크

### 1. Executive Summary (경영진 요약)

**목표**: 바쁜 투자자를 위한 핵심 3줄 요약

```json
{
  "overview": "20건 중 유의미한 팩트는 3건. 나머지는 노이즈",
  "keyFindings": [
    "신제품 발표는 확정, 단 출시일은 미정 (제목 과장 있음)",
    "CEO 발언에서 자신감 감지되나 구체적 목표는 회피",
    "시장은 과열 상태, 단기 조정 가능성 주의"
  ]
}
```

### 2. Market Reaction (시장 반응)

**목표**: 대중 심리 상태 진단

```json
{
  "overview": "개인 투자자는 낙관적이나 기관은 신중. 감정과 이성의 괴리 존재",
  "positiveFactors": [
    "펀더멘털을 실제로 강화시키는 진짜 호재"
  ],
  "neutralFactors": [
    "소문만 무성하고 실체는 아직 불분명한 재료들"
  ],
  "negativeFactors": [
    "단순 악재가 아닌, 구조적인 위험 요인"
  ]
}
```

### 3. Price Impact (주가 영향)

**목표**: 재료의 강도(Intensity)와 지속성 분석

```json
{
  "overview": "단기 모멘텀은 강하나 중기적으로는 소멸 가능성",
  "expectedChange": {
    "shortTerm": "뉴스 반응 과열 시 단기 조정 가능",
    "mediumTerm": "재료 소멸 후 펀더멘털로 회귀",
    "longTerm": "구조적 경쟁력 강화로 장기 긍정적"
  },
  "investmentPoint": "뉴스에 사지 말고 조정 시 매수하라"
}
```

### 4. Competitor Analysis (경쟁사 분석)

**목표**: 제로섬 게임 관점의 산업 분석

```json
{
  "overview": "A사의 악재는 B사의 반사이익 가능성",
  "competitors": [
    {
      "name": "경쟁사 B",
      "analysis": [
        "시장점유율 확대 기회",
        "A사 고객의 이탈 가능성"
      ]
    }
  ],
  "marketOutlook": "업계 판도가 재편되는 중요한 전환점"
}
```

### 5. Risk Factors (리스크 요인)

**목표**: 숫자와 팩트 뒤의 '잠재적 지뢰' 발굴

```json
{
  "overview": "긍정적 뉴스 이면에 규제 리스크 잠복",
  "technical": ["기술 성숙도 의문"],
  "regulatory": ["정부 규제 강화 가능성 (행간에 숨음)"],
  "market": ["경기 둔화 시 수요 급감 우려"],
  "mitigation": "리스크 발생 시 즉시 청산, 손절 라인은 -5%"
}
```

### 6. Investment Recommendation (투자 추천)

**목표**: 역발상 관점의 실전 조언

```json
{
  "recommendation": "HOLD (단기 과열로 신규 매수 부적절)",
  "targetPrices": {
    "shortTerm": "$150 (뉴스 모멘텀 반영)",
    "mediumTerm": "$140 (재료 소멸 후 조정)",
    "longTerm": "$180 (펀더멘털 반영)"
  },
  "reasons": [
    "군중 심리 역이용: 현재 euphoria 단계",
    "데이터 기반: P/E ratio 이미 고평가 구간",
    "역사적 패턴: 유사 뉴스 후 평균 -8% 조정"
  ],
  "monitoringPoints": [
    "'매출 목표 하향'이라는 키워드 나오면 즉시 매도",
    "'주가 급등'을 강조하는 기사는 가짜 신호"
  ],
  "riskWarning": "확증 편향 주의: 좋은 뉴스만 보려는 경향 경계"
}
```

### 7. Conclusion (결론)

**목표**: 한 문장의 강력한 조언

```json
{
  "summary": [
    "재료는 진짜, 주가는 이미 과열",
    "단기 트레이더는 차익실현, 장기 투자자는 조정 대기",
    "리스크/리워드 비율 현재 불리함"
  ],
  "finalOpinion": "좋은 회사, 나쁜 타이밍. 조정을 기다려라.",
  "longTermPerspective": "1년 후에는 '조정 때 샀어야 했다'고 후회할 이슈"
}
```

---

## 출력 구조

### JSON Schema

전체 리포트는 다음 구조를 따릅니다:

```json
{
  "title": "회사명 심층 분석: 뉴스 이면의 진실",
  "analysisPeriod": "최근 7일",
  "sentimentDistribution": {
    "positive": 12,
    "neutral": 5,
    "negative": 3
  },
  "executiveSummary": { ... },
  "marketReaction": { ... },
  "priceImpact": { ... },
  "competitorAnalysis": { ... },
  "riskFactors": { ... },
  "investmentRecommendation": { ... },
  "conclusion": { ... }
}
```

### 데이터 흐름

```
1. 뉴스 수집 (최대 20개)
   ↓
2. 각 뉴스 요약 생성
   - 제목, 출처, 발행일
   - 감정 점수 (0-1)
   - 본문 (2000자 제한)
   - AI 사전 분석
   ↓
3. Claude API 호출
   - Model: claude-sonnet-4-20250514
   - Max tokens: 4096
   - Temperature: default
   ↓
4. JSON 파싱 & 검증
   ↓
5. DB 저장 (24시간 캐시)
   ↓
6. PDF 생성 & 제공
```

---

## 품질 관리

### 1. 노이즈 감지 메커니즘

**자동 필터링**:
- 제목의 해시값으로 중복 기사 감지
- 본문 길이 < 200자 → 저품질 의심
- 광고성 키워드 존재 시 가중치 하향

**AI 판단**:
- 제목-본문 일치도 분석
- 정보의 신뢰도 평가
- 출처의 권위도 고려

### 2. 낚시성 판별 기준

```python
# 예시: 낚시성 기사 패턴
patterns = {
    "제목": "급등 예상! 목표가 2배 상향!",
    "본문": "한 애널리스트는 이렇게 말했다...",
    "판정": "낚시성 - 제목 과장, 본문 근거 빈약"
}
```

### 3. 심리 분석 키워드

```python
confidence_keywords = [
    "확신", "자신감", "강력한", "명확한"
]

anxiety_keywords = [
    "신중한", "조심스러운", "불확실한", "어려움"
]
```

### 4. 역발상 트리거

```python
# 시장 과열 신호
if sentiment_score > 0.85:
    warning = "euphoric phase - 단기 조정 가능성"

# 시장 공포 신호
if sentiment_score < 0.15:
    opportunity = "panic selling - 저가 매수 기회"
```

---

## API 사용 예시

### 리포트 생성

```bash
POST /api/v1/news-report
{
  "symbol": "AAPL",
  "limit": 20
}
```

### 응답 예시

```json
{
  "id": 123,
  "symbol": "AAPL",
  "user_id": "uuid",
  "report_data": {
    "title": "Apple Inc. 심층 분석: 뉴스 이면의 진실",
    "executiveSummary": {
      "overview": "15건의 뉴스 중 유의미한 팩트는 4건...",
      "keyFindings": [
        "iPhone 15 판매량은 공식 발표 아닌 추정치",
        "CEO의 자신감 발언은 있으나 구체적 목표 회피",
        "시장 심리는 과열 상태, 단기 조정 가능성"
      ]
    },
    ...
  },
  "created_at": "2025-01-08T16:30:00Z",
  "expires_at": "2025-01-09T16:30:00Z"
}
```

---

## 모범 사례 (Best Practices)

### 1. 프롬프트 작성

✅ **Good**:
```
"단순 호재가 아닌, 펀더멘털을 실제로 강화시키는 진짜 호재 요인"
```

❌ **Bad**:
```
"긍정적인 요인들"
```

### 2. 분석 깊이

✅ **Good**:
```
"CEO의 '신중한 낙관'은 실적 부진을 방어하려는
 언어적 헤징(linguistic hedging)으로 해석됨"
```

❌ **Bad**:
```
"CEO가 긍정적으로 말했음"
```

### 3. 투자 조언

✅ **Good**:
```
"좋은 회사, 나쁜 타이밍.
 뉴스 모멘텀 소진 후 10% 조정 시 분할 매수 전략"
```

❌ **Bad**:
```
"매수 추천합니다"
```

---

## 향후 개선 방향

### 1. 다중 소스 교차 검증
- 여러 뉴스 소스의 같은 사건 보도 방식 비교
- 편향성 감지 및 중립적 팩트 추출

### 2. 시계열 분석
- 과거 뉴스와 현재 뉴스의 톤 변화 추적
- 경영진 발언의 일관성 모니터링

### 3. 소셜 미디어 통합
- X(Twitter), Reddit 등 소셜 센티먼트 반영
- 기관 vs 개인 투자자 심리 분리 분석

### 4. 백테스팅
- 과거 리포트의 예측 정확도 평가
- AI 추천의 실제 수익률 검증

---

## 참고 자료

- **코드**: `app/services/claude_service.py`
- **API 문서**: `docs/MY_REPORTS_API_GUIDE.md`
- **Claude 모델**: `claude-sonnet-4-20250514`
- **관련 문서**:
  - `docs/NEWS_TRANSLATION_GUIDE.md`
  - `docs/NEWS_AI_SCORE_GUIDE.md`

---

## 라이선스 & 면책조항

본 AI 분석 리포트는 투자 참고 자료일 뿐 투자 권유가 아닙니다.
모든 투자 결정은 본인의 책임 하에 이루어져야 합니다.

---

**문서 버전**: 1.0
**최종 수정일**: 2025-01-08
**작성자**: AI System Documentation
